<style>
  .user-row {
    cursor: default; /* no full-row click to avoid blocking buttons */
  }
  .user-row .collapse-toggle {
    cursor: pointer;
  }
  .btn-icon {
    min-width: 32px;
    padding: 0.25rem 0.5rem;
  }
</style>

<h6 class="border-top border-gray py-2 mb-3 fw-semibold">
  {{.Dictionary.Admin.Users}}
</h6>

<div class="mb-4 d-flex justify-content-between align-items-center">
  <input
    type="search"
    id="searchbar"
    onkeyup="searchFunction()"
    placeholder="Felhasználó keresése.."
    class="form-control me-3"
    style="max-width: 300px;"
    aria-label="Search users"
  >
  <a class="btn btn-success" href="/post/new" role="button">
    + New
  </a>
</div>

<ul class="list-group list-group-flush" id="table" style="max-height: 600px; overflow-y: auto;">
  <li class="list-group-item list-group-item-secondary d-none d-md-flex fw-bold">
    <div class="row w-100 gx-2">
      <div class="col-md-2">{{.Dictionary.Auth.Username}}</div>
      <div class="col-md-3">{{.Dictionary.Auth.Name}}</div>
      <div class="col-md-3">{{.Dictionary.Auth.Email}}</div>
      <div class="col-md-2">{{.Dictionary.Auth.Phone}}</div>
      <div class="col-md-2 text-end">{{.Dictionary.Auth.Roles}}</div>
    </div>
  </li>

  {{range $i, $d := .Dto}}
  <!-- main row -->
  <li
    class="list-group-item p-3 small user-row"
  >
    <div class="row gx-2 align-items-center">
      <div class="col-md-2">
        <a href="/post/{{.Id}}">
          <img src="{{.Image}}" alt="Post image" class="img-fluid rounded" />
        </a>
      </div>
      <div class="col-md-2">
        <a href="/post/{{.Id}}" class="text-decoration-none">@{{shorten .Id 4}}</a>
      </div>
      <div class="col-md-4">
        <strong>{{.Title}}</strong>
        {{if .Public}} <span class="badge bg-success ms-1">Public</span>{{end}}
      </div>
      <div class="col-md-2">{{tformat .EditDate}}</div>
      <div class="col-md-2 text-end">
        <a class="btn btn-sm btn-primary me-1" href="/post/edit/{{.Id}}">Edit</a>
        <a class="btn btn-sm btn-danger" href="/post/delete/{{.Id}}">Delete</a>
        <!-- collapse toggle icon -->
        <button
          class="btn btn-sm btn-outline-secondary collapse-toggle"
          data-bs-toggle="collapse"
          data-bs-target="#collapse-{{$i}}"
          aria-expanded="false"
          aria-controls="collapse-{{$i}}"
          title="Details"
        >
          <i class="bi bi-chevron-down"></i>
        </button>
      </div>
    </div>
  </li>

  <!-- collapse detail -->
  <li
    class="list-group-item border-top p-2 bg-light collapse"
    id="collapse-{{$i}}"
    style="max-height: 400px; overflow-y: auto;"
  >
    <div class="p-2 small">
      <div class="row border-bottom py-1">
        <div class="col-md-2 fw-semibold">ID</div>
        <div class="col-md-10"><a href="/post/{{.Id}}">@{{.Id}}</a></div>
      </div>
      <div class="row border-bottom py-1">
        <div class="col-md-2 fw-semibold">User</div>
        <div class="col-md-10">
          <a href="/user/{{.Author.Username}}">
            @{{if .Author.Name}}{{.Author.Name}}{{else}}{{.Author.Username}}{{end}}
          </a>
        </div>
      </div>
      <div class="row border-bottom py-1">
        <div class="col-md-2 fw-semibold">Date</div>
        <div class="col-md-10">{{tformat .Date}}</div>
      </div>
      <div class="row border-bottom py-1">
        <div class="col-md-2 fw-semibold">Edit Date</div>
        <div class="col-md-10">{{tformat .EditDate}}</div>
      </div>
      <div class="row border-bottom py-1">
        <div class="col-md-2 fw-semibold">Public</div>
        <div class="col-md-10">{{.Public}}</div>
      </div>
      <div class="row border-bottom py-1">
        <div class="col-md-2 fw-semibold">Path</div>
        <div class="col-md-10">{{.Path}}</div>
      </div>
      <div class="row border-bottom py-1">
        <div class="col-md-2 fw-semibold">Short</div>
        <div class="col-md-10">{{.Short}}</div>
      </div>
    </div>
  </li>
  {{end}}
</ul>
